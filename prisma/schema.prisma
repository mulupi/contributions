datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Member {
  id                Int      @id @default(autoincrement())
  createdAt         DateTime @default(now())
  email             String?  @unique
  firstName         String   @db.VarChar(20)
  lastName          String   @db.VarChar(20)
  contributions     Contribution[]
  groups            GroupsOnMembers[]
  individualTarget  Individual_Target[]
}

model Group {
  id            Int      @id @default(autoincrement())
  createdAt     DateTime @default(now())
  name          String   @db.VarChar(20)
  members       GroupsOnMembers[]
  groupTargets  Group_Target[]
}

model GroupsOnMembers {
  group         Group     @relation(fields: [groupId], references: [id])
  groupId       Int 
  member        Member @relation(fields: [memberId], references: [id])
  memberId      Int 
  assignedAt    DateTime @default(now())
  assignedBy    String

  @@id([groupId, memberId])
}

model Contribution {
  id            Int      @id @default(autoincrement())
  createdAt     DateTime @default(now())
  amount        Float
  contributor   Member @relation(fields: [contributorId], references: [id])
  contributorId Int
  Event         Event  @relation(fields: [eventId], references: [id])
  eventId       Int
}

model Event {
  id                Int      @id @default(autoincrement())
  createdAt         DateTime @default(now())
  name              String   @db.VarChar(30)
  contributions     Contribution[]
  individualTargets Individual_Target[]
  groupTargets      Group_Target[]
}

model Group_Target {
  id          Int      @id @default(autoincrement())
  createdAt   DateTime @default(now())
  target      Float 
  event       Event @relation(fields: [eventId], references: [id])
  eventId     Int 
  group       Group @relation(fields: [groupId], references: [id])
  groupId     Int
}

model Individual_Target {
  id          Int      @id @default(autoincrement())
  createdAt   DateTime @default(now())
  target      Float
  member      Member @relation(fields: [memberId], references: [id])
  memberId    Int
  event       Event @relation(fields: [eventId], references: [id])
  eventId     Int
}

enum Role {
  USER
  ADMIN
}